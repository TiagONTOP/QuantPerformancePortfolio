================================================================================
GPU MONTE CARLO - COMPLETE TEST AND BENCHMARK RESULTS
================================================================================
Date: 2025-11-03 18:17:00
================================================================================


================================================================================
                       COMPLETE TEST AND BENCHMARK SUITE                        
================================================================================


================================================================================
                           PHASE 1: CORRECTNESS TESTS                           
================================================================================


================================================================================
Test: GPU Correctness Tests (test_correctness_gpu.py)
Command: pytest tests/test_correctness_gpu.py -v
Time: 2025-11-03 18:17:00
================================================================================

============================= test session starts =============================
platform win32 -- Python 3.12.3, pytest-8.4.2, pluggy-1.6.0 -- C:\Users\ftiag\Desktop\Quant\B2B Quant\CodeOptimisation\quant-performance-portfolio\case_studies\04_gpu_monte_carlo\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\ftiag\Desktop\Quant\B2B Quant\CodeOptimisation\quant-performance-portfolio\case_studies\04_gpu_monte_carlo
configfile: pyproject.toml
collecting ... collected 20 items

tests/test_correctness_gpu.py::TestGPUCorrectness::test_output_shape PASSED [  5%]
tests/test_correctness_gpu.py::TestGPUCorrectness::test_all_finite_values PASSED [ 10%]
tests/test_correctness_gpu.py::TestGPUCorrectness::test_initial_price PASSED [ 15%]
tests/test_correctness_gpu.py::TestGPUCorrectness::test_time_grid PASSED [ 20%]
tests/test_correctness_gpu.py::TestInputValidation::test_invalid_s0 PASSED [ 25%]
tests/test_correctness_gpu.py::TestInputValidation::test_invalid_sigma PASSED [ 30%]
tests/test_correctness_gpu.py::TestInputValidation::test_invalid_maturity PASSED [ 35%]
tests/test_correctness_gpu.py::TestInputValidation::test_invalid_n_steps PASSED [ 40%]
tests/test_correctness_gpu.py::TestInputValidation::test_invalid_n_paths PASSED [ 45%]
tests/test_correctness_gpu.py::TestStatisticalMoments::test_log_returns_mean_gpu PASSED [ 50%]
tests/test_correctness_gpu.py::TestStatisticalMoments::test_log_returns_std_gpu PASSED [ 55%]
tests/test_correctness_gpu.py::TestReproducibility::test_gpu_reproducibility PASSED [ 60%]
tests/test_correctness_gpu.py::TestGPUvsCPUParity::test_gpu_cpu_parity_float64 PASSED [ 65%]
tests/test_correctness_gpu.py::TestGPUvsCPUParity::test_gpu_cpu_parity_float32 PASSED [ 70%]
tests/test_correctness_gpu.py::TestAntitheticVariates::test_antithetic_reduces_variance_gpu PASSED [ 75%]
tests/test_correctness_gpu.py::TestAntitheticVariates::test_antithetic_shape_odd_paths PASSED [ 80%]
tests/test_correctness_gpu.py::TestDtypeSupport::test_float32_gpu PASSED [ 85%]
tests/test_correctness_gpu.py::TestDtypeSupport::test_float64_gpu PASSED [ 90%]
tests/test_correctness_gpu.py::TestDividendYield::test_dividend_yield_effect PASSED [ 95%]
tests/test_correctness_gpu.py::TestMemoryChunking::test_chunking_same_result PASSED [100%]

============================= 20 passed in 1.65s ==============================


[OK] PASSED: GPU Correctness Tests (test_correctness_gpu.py)
================================================================================


================================================================================
Test: General Correctness Tests (test_correctness.py)
Command: pytest tests/test_correctness.py -v
Time: 2025-11-03 18:17:03
================================================================================

============================= test session starts =============================
platform win32 -- Python 3.12.3, pytest-8.4.2, pluggy-1.6.0 -- C:\Users\ftiag\Desktop\Quant\B2B Quant\CodeOptimisation\quant-performance-portfolio\case_studies\04_gpu_monte_carlo\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\ftiag\Desktop\Quant\B2B Quant\CodeOptimisation\quant-performance-portfolio\case_studies\04_gpu_monte_carlo
configfile: pyproject.toml
collecting ... collected 27 items

tests/test_correctness.py::TestBasicCorrectness::test_output_shape_cpu PASSED [  3%]
tests/test_correctness.py::TestBasicCorrectness::test_output_shape_gpu PASSED [  7%]
tests/test_correctness.py::TestBasicCorrectness::test_all_finite_values PASSED [ 11%]
tests/test_correctness.py::TestBasicCorrectness::test_all_finite_values_gpu PASSED [ 14%]
tests/test_correctness.py::TestBasicCorrectness::test_initial_price PASSED [ 18%]
tests/test_correctness.py::TestBasicCorrectness::test_time_grid PASSED   [ 22%]
tests/test_correctness.py::TestInputValidation::test_invalid_s0 PASSED   [ 25%]
tests/test_correctness.py::TestInputValidation::test_invalid_sigma PASSED [ 29%]
tests/test_correctness.py::TestInputValidation::test_invalid_maturity PASSED [ 33%]
tests/test_correctness.py::TestInputValidation::test_invalid_n_steps PASSED [ 37%]
tests/test_correctness.py::TestInputValidation::test_invalid_n_paths PASSED [ 40%]
tests/test_correctness.py::TestInputValidation::test_invalid_backend SKIPPED [ 44%]
tests/test_correctness.py::TestStatisticalMoments::test_log_returns_mean_cpu PASSED [ 48%]
tests/test_correctness.py::TestStatisticalMoments::test_log_returns_std_cpu PASSED [ 51%]
tests/test_correctness.py::TestStatisticalMoments::test_log_returns_mean_cupy PASSED [ 55%]
tests/test_correctness.py::TestReproducibility::test_cpu_reproducibility PASSED [ 59%]
tests/test_correctness.py::TestReproducibility::test_cupy_reproducibility PASSED [ 62%]
tests/test_correctness.py::TestBackendParity::test_cpu_cupy_parity_float64 PASSED [ 66%]
tests/test_correctness.py::TestBackendParity::test_cpu_cupy_parity_float32 PASSED [ 70%]
tests/test_correctness.py::TestAntitheticVariates::test_antithetic_reduces_variance_cpu PASSED [ 74%]
tests/test_correctness.py::TestAntitheticVariates::test_antithetic_shape_odd_paths PASSED [ 77%]
tests/test_correctness.py::TestAntitheticVariates::test_antithetic_cupy PASSED [ 81%]
tests/test_correctness.py::TestDtypeSupport::test_float32_cpu PASSED     [ 85%]
tests/test_correctness.py::TestDtypeSupport::test_float64_cpu PASSED     [ 88%]
tests/test_correctness.py::TestDtypeSupport::test_float32_cupy PASSED    [ 92%]
tests/test_correctness.py::TestDividendYield::test_dividend_yield_effect PASSED [ 96%]
tests/test_correctness.py::TestMemoryChunking::test_chunking_same_result PASSED [100%]

======================== 26 passed, 1 skipped in 6.82s ========================


[OK] PASSED: General Correctness Tests (test_correctness.py)
================================================================================


================================================================================
Test: Asian Option Correctness Tests
Command: pytest tests/test_asian_option_correctness.py -v
Time: 2025-11-03 18:17:10
================================================================================

============================= test session starts =============================
platform win32 -- Python 3.12.3, pytest-8.4.2, pluggy-1.6.0 -- C:\Users\ftiag\Desktop\Quant\B2B Quant\CodeOptimisation\quant-performance-portfolio\case_studies\04_gpu_monte_carlo\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\ftiag\Desktop\Quant\B2B Quant\CodeOptimisation\quant-performance-portfolio\case_studies\04_gpu_monte_carlo
configfile: pyproject.toml
collecting ... collected 22 items

tests/test_asian_option_correctness.py::TestAsianOptionBasics::test_call_option_itm PASSED [  4%]
tests/test_asian_option_correctness.py::TestAsianOptionBasics::test_put_option_itm PASSED [  9%]
tests/test_asian_option_correctness.py::TestAsianOptionBasics::test_call_option_otm PASSED [ 13%]
tests/test_asian_option_correctness.py::TestAsianOptionBasics::test_put_option_otm PASSED [ 18%]
tests/test_asian_option_correctness.py::TestAsianOptionBasics::test_call_option_atm PASSED [ 22%]
tests/test_asian_option_correctness.py::TestAsianOptionInputValidation::test_invalid_time_grid_empty PASSED [ 27%]
tests/test_asian_option_correctness.py::TestAsianOptionInputValidation::test_invalid_paths_1d PASSED [ 31%]
tests/test_asian_option_correctness.py::TestAsianOptionInputValidation::test_mismatched_dimensions PASSED [ 36%]
tests/test_asian_option_correctness.py::TestAsianOptionInputValidation::test_invalid_option_type PASSED [ 40%]
tests/test_asian_option_correctness.py::TestGPUvsCPUParity::test_call_parity_with_same_shocks PASSED [ 45%]
tests/test_asian_option_correctness.py::TestGPUvsCPUParity::test_put_parity_with_same_shocks PASSED [ 50%]
tests/test_asian_option_correctness.py::TestGPUvsCPUParity::test_multiple_strikes_parity PASSED [ 54%]
tests/test_asian_option_correctness.py::TestGPUvsCPUParity::test_parity_float32 PASSED [ 59%]
tests/test_asian_option_correctness.py::TestAsianOptionStatisticalProperties::test_call_put_parity_approximate PASSED [ 63%]
tests/test_asian_option_correctness.py::TestAsianOptionStatisticalProperties::test_increasing_volatility_increases_price PASSED [ 68%]
tests/test_asian_option_correctness.py::TestAsianOptionStatisticalProperties::test_price_converges_with_sample_size PASSED [ 72%]
tests/test_asian_option_correctness.py::TestAsianOptionEdgeCases::test_zero_volatility PASSED [ 77%]
tests/test_asian_option_correctness.py::TestAsianOptionEdgeCases::test_very_deep_itm_call PASSED [ 81%]
tests/test_asian_option_correctness.py::TestAsianOptionEdgeCases::test_very_deep_otm_call PASSED [ 86%]
tests/test_asian_option_correctness.py::TestAsianOptionDifferentMaturities::test_short_maturity PASSED [ 90%]
tests/test_asian_option_correctness.py::TestAsianOptionDifferentMaturities::test_long_maturity PASSED [ 95%]
tests/test_asian_option_correctness.py::TestAsianOptionAntithetic::test_antithetic_reduces_variance PASSED [100%]

============================= 22 passed in 6.30s ==============================


[OK] PASSED: Asian Option Correctness Tests
================================================================================


================================================================================
                            PHASE 2: BENCHMARK TESTS                            
================================================================================


================================================================================
Test: GPU Benchmarks (test_benchmark_gpu.py)
Command: pytest tests/test_benchmark_gpu.py -v
Time: 2025-11-03 18:17:17
================================================================================

============================= test session starts =============================
platform win32 -- Python 3.12.3, pytest-8.4.2, pluggy-1.6.0 -- C:\Users\ftiag\Desktop\Quant\B2B Quant\CodeOptimisation\quant-performance-portfolio\case_studies\04_gpu_monte_carlo\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\ftiag\Desktop\Quant\B2B Quant\CodeOptimisation\quant-performance-portfolio\case_studies\04_gpu_monte_carlo
configfile: pyproject.toml
collecting ... collected 8 items

tests/test_benchmark_gpu.py::TestBenchmarkSmall::test_small_problem_gpu PASSED [ 12%]
tests/test_benchmark_gpu.py::TestBenchmarkSmall::test_small_problem_cpu PASSED [ 25%]
tests/test_benchmark_gpu.py::TestBenchmarkMedium::test_medium_problem_gpu PASSED [ 37%]
tests/test_benchmark_gpu.py::TestBenchmarkMedium::test_medium_problem_cpu PASSED [ 50%]
tests/test_benchmark_gpu.py::TestBenchmarkLarge::test_large_problem_gpu PASSED [ 62%]
tests/test_benchmark_gpu.py::TestBenchmarkLarge::test_large_problem_cpu PASSED [ 75%]
tests/test_benchmark_gpu.py::TestSpeedupComparison::test_gpu_vs_cpu_speedup PASSED [ 87%]
tests/test_benchmark_gpu.py::TestDtypePerformance::test_gpu_dtype_comparison PASSED [100%]

============================= 8 passed in 19.12s ==============================


[OK] PASSED: GPU Benchmarks (test_benchmark_gpu.py)
================================================================================


================================================================================
Test: New Benchmarks (test_benchmark_new.py)
Command: pytest tests/test_benchmark_new.py -v
Time: 2025-11-03 18:17:37
================================================================================

============================= test session starts =============================
platform win32 -- Python 3.12.3, pytest-8.4.2, pluggy-1.6.0 -- C:\Users\ftiag\Desktop\Quant\B2B Quant\CodeOptimisation\quant-performance-portfolio\case_studies\04_gpu_monte_carlo\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\ftiag\Desktop\Quant\B2B Quant\CodeOptimisation\quant-performance-portfolio\case_studies\04_gpu_monte_carlo
configfile: pyproject.toml
collecting ... collected 8 items

tests/test_benchmark_new.py::TestBenchmarkSmall::test_small_problem_cpu PASSED [ 12%]
tests/test_benchmark_new.py::TestBenchmarkSmall::test_small_problem_cupy PASSED [ 25%]
tests/test_benchmark_new.py::TestBenchmarkMedium::test_medium_problem_cpu PASSED [ 37%]
tests/test_benchmark_new.py::TestBenchmarkMedium::test_medium_problem_cupy PASSED [ 50%]
tests/test_benchmark_new.py::TestBenchmarkLarge::test_large_problem_cpu PASSED [ 62%]
tests/test_benchmark_new.py::TestBenchmarkLarge::test_large_problem_cupy PASSED [ 75%]
tests/test_benchmark_new.py::TestSpeedupComparison::test_cupy_vs_cpu_speedup PASSED [ 87%]
tests/test_benchmark_new.py::TestDtypePerformance::test_cupy_dtype_comparison PASSED [100%]

============================= 8 passed in 19.22s ==============================


[OK] PASSED: New Benchmarks (test_benchmark_new.py)
================================================================================


================================================================================
Test: Asian Option Benchmarks
Command: pytest tests/test_asian_option_benchmark.py -v
Time: 2025-11-03 18:17:57
================================================================================

============================= test session starts =============================
platform win32 -- Python 3.12.3, pytest-8.4.2, pluggy-1.6.0 -- C:\Users\ftiag\Desktop\Quant\B2B Quant\CodeOptimisation\quant-performance-portfolio\case_studies\04_gpu_monte_carlo\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\ftiag\Desktop\Quant\B2B Quant\CodeOptimisation\quant-performance-portfolio\case_studies\04_gpu_monte_carlo
configfile: pyproject.toml
collecting ... collected 9 items

tests/test_asian_option_benchmark.py::TestAsianOptionBenchmarkSmall::test_small_cpu PASSED [ 11%]
tests/test_asian_option_benchmark.py::TestAsianOptionBenchmarkSmall::test_small_gpu PASSED [ 22%]
tests/test_asian_option_benchmark.py::TestAsianOptionBenchmarkMedium::test_medium_cpu PASSED [ 33%]
tests/test_asian_option_benchmark.py::TestAsianOptionBenchmarkMedium::test_medium_gpu PASSED [ 44%]
tests/test_asian_option_benchmark.py::TestAsianOptionBenchmarkLarge::test_large_cpu PASSED [ 55%]
tests/test_asian_option_benchmark.py::TestAsianOptionBenchmarkLarge::test_large_gpu PASSED [ 66%]
tests/test_asian_option_benchmark.py::TestAsianOptionSpeedupComparison::test_speedup_medium_problem PASSED [ 77%]
tests/test_asian_option_benchmark.py::TestAsianOptionSpeedupComparison::test_speedup_breakdown PASSED [ 88%]
tests/test_asian_option_benchmark.py::TestAsianOptionDtypePerformance::test_gpu_dtype_comparison PASSED [100%]

============================= 9 passed in 27.40s ==============================


[OK] PASSED: Asian Option Benchmarks
================================================================================


================================================================================
                           TEST AND BENCHMARK SUMMARY                           
================================================================================


Detailed Results:
--------------------------------------------------------------------------------
Gpu Correctness                          [OK] PASSED
Correctness                              [OK] PASSED
Asian Correctness                        [OK] PASSED
Gpu Benchmarks                           [OK] PASSED
New Benchmarks                           [OK] PASSED
Asian Benchmarks                         [OK] PASSED

================================================================================
TOTAL: 6/6 test suites passed
================================================================================

================================================================================
[SUCCESS] ALL TEST SUITES PASSED!
================================================================================
